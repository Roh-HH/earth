<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
<mapper namespace="board">

	<select id="countAllNotice" resultType="int">
		select count(*) from notice
	</select>
	<select id="countAllFree" resultType="int">
		select count(*) from free
	</select>
	<select id="countAllDiary" resultType="int">
		select count(*) from diary
	</select>
	<select id="countAllChallenge" resultType="int">
		select count(*) from challenge
	</select>
	<select id="countAllToday" resultType="int">
		select count(*) from today
	</select>
	<select id="countAllShop" resultType="int">
		select count(*) from shop
	</select>
	<select id="countAllEvent" resultType="int">
		select count(*) from event
	</select>
	<select id="countAllTip" resultType="int">
		select count(*) from tip
	</select>
	
	<select id="getNoticeArticles" parameterType="hashmap" resultType="noticeDTO">		
		<![CDATA[
			select B.* from (select A.*, rownum r from (select * from notice order by reg desc) A) B where r >= #{start} and r <= #{end}
		]]>
	</select>
	<select id="getNoticeArticle" parameterType="int" resultType="noticeDTO">
			select * from notice where boardnum = #{value}
	</select>
	
	<select id="getTodayArticles" parameterType="hashmap" resultType="todayDTO">		
		<![CDATA[
			select B.* from (select A.*, rownum r from (select * from today order by reg desc) A) B where r >= #{start} and r <= #{end} and to_char(reg,'YY/MM/DD') >= to_char(sysdate, 'YY/MM/DD')
		]]>
	</select>

	<insert id="insertNotice" parameterType="noticeDTO">
		insert into notice values(notice_seq.nextval, #{subject}, #{id}, #{pw}, #{ctt}, #{img}, sysdate, #{readcount}, #{code})
	</insert>
	<insert id="upload" parameterType="todayDTO">
		insert into today values(today_seq.nextval, #{id}, #{ctt}, sysdate, #{code}, #{condition}) 
	</insert>
	
	<update id="addReadCountNotice" parameterType="int">
		<![CDATA[
			update notice set readcount=readcount+1 where boardnum = #{value}
		]]>
	</update>
	<update id="updateNoticeArticle" parameterType="noticeDTO">
		update notice set subject = #{subject}, ctt = #{ctt} where boardnum = #{boardnum} and pw = #{pw}
	</update>
	<update id="updateNoticeArticleImg" parameterType="noticeDTO">
		update notice set subject = #{subject}, ctt = #{ctt}, img = #{img} where boardnum = #{boardnum} and pw = #{pw}
	</update>
	
</mapper>
